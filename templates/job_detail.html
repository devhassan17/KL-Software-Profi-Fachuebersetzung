{% extends "base.html" %}
{% block content %}
<div class="card-title">
  Job {{ job.job_uuid[:8] }}…
  <span class="badge status-{{ job.status }}">{{ job.status }}</span>
</div>

<p class="text-muted">
  {{ job.source_lang or "AUTO" }} → {{ job.target_lang }} ·
  Domain: {{ job.domain }} · Tone: {{ job.tone or "neutral" }} ·
  Words: {{ job.word_count or "–" }} ·
  Price: {{ job.price_estimate if job.price_estimate is not none else "–" }}
</p>

{% if job.error_message %}
  <p style="color:#b91c1c; font-size:.85rem;"><strong>Error:</strong> {{ job.error_message }}</p>
{% endif %}

<h3 style="font-size:1rem; margin-top:1rem;">Original</h3>
<pre>{{ job.original_text | e }}</pre>

<h3 style="font-size:1rem; margin-top:1rem;">Translated</h3>
<pre>{{ job.translated_text | e }}</pre>

<div style="margin-top:1rem;">
  <a class="btn btn-secondary" href="{{ url_for('download_job', job_uuid=job.job_uuid) }}">Download TXT</a>
</div>

<h3 style="font-size:1rem; margin-top:1.5rem;">Audit log</h3>
<ul style="list-style:none; padding:0; font-size:.8rem; color:#6b7280;">
  {% for ev in job.audit_events|sort(attribute="created_at") %}
    <li>
      <strong>{{ ev.created_at.strftime('%Y-%m-%d %H:%M') }}</strong> –
      <span style="text-transform:uppercase; font-size:.7rem;">{{ ev.event_type }}</span> –
      {{ ev.description }}
    </li>
  {% endfor %}
</ul>
{% endblock %}
